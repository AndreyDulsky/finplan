{"version":3,"file":"spreadsheet.js","sources":["../sources/math/parser.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/editors/excel_filter.js","../sources/math/methods/helpers.js","../sources/editors/date_editor.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/date.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/image.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/lock_cell.js","../sources/operations/undo.js","../sources/operations/spans.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/types.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/filter.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["function isChar(char){\n\tvar code = char.charCodeAt(0);\n\t// #(35) - errors like #REF!, $(36) - absolute cell reference, a-zA-Z(65-122) - chars\n\treturn (code>=65 && code<=122) || code == 35 || code == 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nfunction errorCode(e){\n\treturn `this.e(\"${e}\")`;\n}\n\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet){\n\t\t\t\t\t\t\t// 'sheet'! - 3 extra symbols, sheet! - 1 extra symbol\n\t\t\t\t\t\t\ti += sheet.length + (escaped ? 3 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\tvalue = [sheet, word, escaped];\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\n\tif (formula[0] != \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t}\n\t\telse if (!quotes && (key == \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\t//errors like #REF!\n\t\t\tif(word[0] == \"#\"){\n\t\t\t\tcode += errorCode(word);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (formula[i+1] == \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t}\n\t\t\telse if (isPosition(word)){\n\t\t\t\tif (formula[i+1] == \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else \n\t\t\t\t\t\tcode += operandCode(deps, word, sheet);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\"){\n\t\t\t\t\tcode += errorCode(\"#REF!\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-value\": \"Value\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"graph\": \"Graph\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"create-filter\": \"Create filter\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\"\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t}\n},webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tif(value){\n\t\t\tcolorboard.setValue(value);\n\t\t\tthis.config.value = value;\n\t\t\tthis.getColorNode().style.backgroundColor = value;\n\t\t}\n\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t},\n\tgetHeaderConfig: function(label){\n\t\treturn {\n\t\t\tpaddingX: 10,\n\t\t\tpaddingY: 5,\n\t\t\theight: 60,\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: label},\n\t\t\t\t{ view: \"icon\", css:\"webix_ssheet_hide_icon\", icon:\"webix_ssheet_icon ssi-close\", width: 50, click: function(){\n\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\tparentView.callEvent(\"onHideClick\",[]);\n\t\t\t\t}}\n\t\t\t]\n\t\t};\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpaddingY: 0,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\telements.push({height:10, borderless: true});\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tvalue.paddingY = value.paddingY||0;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\thead_setter:function(value){\n\t\tif(value){\n\t\t\tvalue = this.getHeaderConfig(value);\n\t\t}\n\t\treturn webix.ui.window.prototype.head_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tpadding:0,\n\t\tmove:true,\n\t\thead: true,\n\t\tbuttons: true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_table webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif((i+1)%2 != 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\t\tdelete master.$handleSelection;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = webix.template.escape(this.getValue());\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse if (newv != master.getCellValue(cell.row, cell.column)){\n\t\t\tthis.config.value = newv;\n\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\tmaster.refresh();\n\t\t}\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\t\t\tconst updatedStr = str1.replace(/([a-zA-Z(]+)$/, value);\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = (updatedStr == str1 ? str1 + value : updatedStr) + \"(\";\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\treturn text[0] == \"=\" && text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","const conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t\"equal\", \"notEqual\", \"contains\", \"notContains\"\n\t],\n\ttext: [\"contains\", \"notContains\", \"equal\", \"notEqual\", \"beginsWith\", \"notBeginsWith\", \"endsWith\", \"notEndsWith\"]\n};\n\nfunction getConditions(name){\n\tconst con = conditions[name];\n\tconst locale = webix.i18n.filter;\n\n\tfor (let i=0; i<con.length; i++)\n\t\tif (con[i].id)\n\t\t\tcon[i].value = locale[con[i].id];\n\n\treturn con;\n}\n\nfunction getLabel(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn locale[ this.name ];\n}\n\nwebix.editors.ss_excel_filter = webix.extend({\n\tfocus:function(){},\n\tgetValue:function(){\n\t\tconst filter = this.getFilter();\n\t\tconst value = filter.getValue();\n\n\t\tthis.config.filter[2] = filter.getFilterFunction();\n\n\t\tvalue.toString = function(){ return \"&nbsp\"; };\n\t\tvalue.$mode = filter.config.mode;\n\n\t\treturn value;\n\t},\n\tsetValue:function(value){\n\t\tconst list = this.getInputNode();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.config.$mode){\n\t\t\tfilter.define(\"conditions\", getConditions(this.config.$mode));\n\t\t\tfilter.define(\"mode\", this.config.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tif (value && value.$mode !== this.config.$mode)\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(this.config.options);\n\n\t\tthis.getPopup().show(this.node);\n\t\tfilter.setValue(value);\n\t\tfilter.$initialValue = value ? webix.copy(value) : {};\n\t},\n\tgetInputNode:function(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t},\n\tgetFilter:function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetEditorArea:function(){\n\t\tconst popup = this.getPopup();\n\t\tconst rs_popup = popup.queryView(\"richselect\").getPopup();\n\n\t\treturn [popup.$view, rs_popup.$view];\n\t},\n\tpopupInit:function(popup){\n\t\tconst buttons = popup.queryView(\"button\", \"all\");\n\n\t\tbuttons[0].attachEvent(\"onItemClick\", () => {\n\t\t\tconst filter = this.getFilter();\n\t\t\tfilter.setValue( webix.copy(filter.$initialValue) );\n\n\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t});\n\t\tbuttons[1].attachEvent(\"onItemClick\", () => {\n\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t});\n\t},\n\tpopupType:\"ss_excel_filter\"\n}, webix.editors.popup);\n\nwebix.editors.$popup.ss_excel_filter = {\n\tview:\"popup\", padding:7, relative:\"right\",\n\tbody:{ margin:4, rows:[\n\t\t{ view:\"filter\", field:\"value\", mode:\"text\", conditions:getConditions(\"text\"), template:function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t}},\n\t\t{ cols:[\n\t\t\t{ },\n\t\t\t{ view:\"button\", label:{ name:\"cancel\", toString:getLabel }, autowidth:true, css:\"webix_transparent\" },\n\t\t\t{ view:\"button\", label:{ name:\"apply\", toString:getLabel }, autowidth:true, css:\"webix_secondary\" }\n\t\t]}\n\t]}\n};","export function dayOfTheYear(date){\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\treturn Math.floor(diff / (1000 * 60 * 60 * 24));\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date((excelDate - 25569) * 86400 * 1000);\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}\n\nexport function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nexport function _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\n\nwebix.editors.excel_date = webix.extend({\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().getValue();\n\t\treturn value ? getExcelDateFromJs(value) : \"\";\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\twebix.editors.popup.setValue.call(this, value);\n\t},\n\tpopupType:\"excel_date\"\n}, webix.editors.date);\n\nwebix.editors.$popup.excel_date = {\n\tview:\"popup\",\n\tbody:{ \n\t\tview:\"calendar\",\n\t\ticons:true,\n\t\ttimepicker:true\n\t}\n};\n","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"top\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"vertical-align\": {\n\t\t\"top\": function(){\n\t\t\treturn \"display: block;\";\n\t\t},\n\t\t\"middle\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items: center;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t},\n\t\t\"bottom\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items:flex-end;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t}\n\t},\n\t\"wrap\": {\n\t\t\"wrap\": function(){\n\t\t\tvar padding = 7 - (34-webix.skin.$active.rowHeight);\n\t\t\treturn \"white-space: normal !important; line-height:normal !important; padding-top:\"+padding+\"px;padding-bottom:\"+padding+\"px;\";\n\t\t},\n\t\t\"nowrap\": function(){\n\t\t\treturn \"\";\n\t\t}\n\t},\n\t\"format\":\"\",\n\t\"borders\": \"\",\n\t\"border-left\":function(obj){\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":function(obj){\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\":function(obj){\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": function(obj){\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": function(obj){\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst item = view.getRow(row);\n\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, x, y){\n\tlet width = 0;\n\tlet height = 0;\n\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = (x||1)+\"px\";\n\tsizeEl.style.height = (y||1)+\"px\";\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\twidth = Math.max(width, sizeEl.scrollWidth);\n\theight = Math.max(height, sizeEl.scrollHeight);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width: width, height: height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tgroup.set(()=>{\n\t\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\t\t\tview.saveCell(cell.row,cell.column);\n\t\t}\n\t});\t\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport {getJsDateFromExcel} from \"../math/methods/helpers\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tgetFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction getFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tvar old = view.getStyle(row, column);\n\tvar fmtstring = getFormatName(format, type);\n\tvar nev = addStyle(view, { format: fmtstring }, old);\n\tview.setStyle(row, column, nev);\n}\n\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tlet format, length, type;\n\n\t//types based on last date type\n\tif(text.indexOf(\"m\") == 0){\n\t\tconst order = lastDateType == \"date\" ? dateOrder : timeOrder;\n\t\tfor(let i = 0; i < order.length; i++){\n\t\t\tif(text.indexOf(order[i]) == 0){\n\t\t\t\tformat = (lastDateType == \"date\" ? dateTypes : timeTypes)[order[i]];\n\t\t\t\tlength = order[i].length;\n\t\t\t\ttype = lastDateType;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\t//firstly check date based types\n\t\tfor(let i = 0; i < dateOrder.length; i++){\n\t\t\tif(text.indexOf(dateOrder[i]) == 0){\n\t\t\t\tformat = dateTypes[dateOrder[i]];\n\t\t\t\tlength = dateOrder[i].length;\n\t\t\t\ttype = \"date\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!type){\n\t\t\tfor(let i = 0; i < timeOrder.length; i++){\n\t\t\t\tif(text.indexOf(timeOrder[i]) == 0){\n\t\t\t\t\tformat = timeTypes[timeOrder[i]];\n\t\t\t\t\tlength = timeOrder[i].length;\n\t\t\t\t\ttype = \"time\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {format, type, length};\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart.format){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? ` val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tconst name = view.getStyle(cells[0].row, cells[0].column).props.format;\n\t\tview.$$(\"bar\").setValues({format:name.indexOf(\"fmt\") < 0 ? name : \"custom\"}, true);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text  = \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(name, type){\n\tconst format = getFormatSource(name);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i));\n\t\t\t\tif(datePart.format)\n\t\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn   {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", type:\"htmlbutton\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue: \"wrap\",offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"add-image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"add-sparkline\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tvar styles = {};\n\tvar cell = selected[0];\n\tif(cell){\n\t\tvar obj = view.getStyle(cell.row, cell.column);\n\t\tif (obj)\n\t\t\tstyles = obj.props;\n\t}\n\n\tvar barStyles = webix.copy(styles);\n\n\tfor(var i in defaultStyles){\n\t\tif(!barStyles[i])\n\t\t\tbarStyles[i] = defaultStyles[i];\n\t}\n\n\tbarStyles.format = isCustom(barStyles.format) ? \"custom\" : barStyles.format;\n\n\tview.$$(\"bar\").setValues(barStyles);\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\t\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\t\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\n\tview._table.eachRow(function(row) {\n\t\tconst rowobj = this.getItem(row);\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, 0, rowobj.$height);\n\t\t\tif (size.width > width) width = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\t\n\tview._table.eachColumn(function(column) {\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, this.getColumnConfig(column).width, 0);\n\t\t\tif (size.height > height) height = size.height;\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\t\n\tvar sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row >=sr && row<=er)\n\t\t\tview._table.addCellCss(row, \"rowId\", \"webix_highlight\");\n\t\telse \n\t\t\tview._table.removeCellCss(row, \"rowId\", \"webix_highlight\");\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tvar node = view._table.getHeaderNode(col);\n\t\tif(!node) return;\n\n\t\tif(col >=sc && col<=ec)\n\t\t\twebix.html.addCss(node, \"webix_highlight\");\n\t\telse\n\t\t\twebix.html.removeCss(node, \"webix_highlight\");\n\t});\n}\n\n\n\n\n\n\n","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\tview.attachEvent(\"onDestruct\", () => webix.eventRemove(showHandler));\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\t\n\t//column drag event checking\n\tlet dragStartColumn;\n\tgrid.$view.firstChild.addEventListener(\"mousedown\", (e)=>{\n\t\t//column ids are starting from 0, thats why we adding 1\n\t\tdragStartColumn = e.target.parentNode.cellIndex + 1;\n\t});\n\tgrid.$view.firstChild.addEventListener(\"mouseup\", (e)=>{\n\t\tconst dragEndColumn = e.target.parentNode.cellIndex + 1;\n\t\tif (dragStartColumn && dragStartColumn !== dragEndColumn) {\n\t\t\tcop.selectColumn(dragStartColumn, view, dragEndColumn);\n\t\t\tdragStartColumn = undefined;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\tgrid.attachEvent(\"onSelectChange\", () => {\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t} else {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n}\n\nfunction cell_template(view, obj, common, value, column){\n\tconst format = obj.$cellFormat ? obj.$cellFormat[column.id] : null;\n\tconst commented = view.comments.get(obj.id, column.id) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\n\tconst text = value === \"\" || isNaN(value);\n\t//text can be formatted only in case of string number format\n\tif(!text || fmt.checkFormat(format, \"string\")){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newvalue = helper(value, cell);\n\n\t\t\t\tif(newvalue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\treturn \"<div class='\"+cell.css+\"'>\"+newvalue+\"</div>\"+commented; \n\t\t\t\t\treturn newvalue+commented;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\treturn value+commented;\n}\n\nexport function reset(view){\n\tvar grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tvar columns = view.config.columnCount;\n\tvar rows = view.config.rowCount;\n\n\tvar cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate(el) {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i <= columns; i++) {\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader: {\n\t\t\t\ttext: nms.encode[i],\n\t\t\t\tcss: view._hideColumn && view._hideColumn.indexOf(i+1) >= 0 ? \"webix_ssheet_hide_column\" : \"\"\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\n\tgrid.refreshColumns(cols);\n\n\tif(view._hideColumn && view._hideColumn.length)\n\t\tview._hideColumn.map(id => grid.hideColumn(id));\n\n\n\tvar data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n\n\tif(view._hideRow && view._hideRow.length) {\n\t\tgrid.filter(function(obj){\n\t\t\tif(view._hideRow.indexOf(obj.id) === -1) {\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tif(obj.id - 1 === 0){\n\t\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\t\t\tview.$$(\"cells\").refreshColumns();\n\t\t\t\t}else {\n\t\t\t\t\tview.$$(\"cells\").addCellCss(obj.id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {_to_number, _combine} from \"./helpers\";\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","import {getJsDateFromExcel, getExcelDateFromJs, dayOfTheYear} from \"./helpers\";\n\nexport function DATE(year, month, day){\n\tconst date = new Date(year, month-1, day);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function TIME(hour, minute, second){\n\tconst date = new Date(1900, 0, 1, hour, minute, second);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DAY(date){\n\treturn getJsDateFromExcel(date).getDate();\n}\n\nexport function MONTH(date){\n\treturn getJsDateFromExcel(date).getMonth()+1;\n}\n\nexport function YEAR(date){\n\treturn getJsDateFromExcel(date).getFullYear();\n}\n\nexport function NOW(){\n\tconst date = new Date();\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DATEDIF(start, end, unit){\n\tif(unit != \"D\"){\n\t\tstart = getJsDateFromExcel(start);\n\t\tend = getJsDateFromExcel(end);\n\t}\n\n\tswitch(unit){\n\t\tcase \"Y\":\n\t\t\treturn end.getFullYear() - start.getFullYear();\n\t\tcase \"M\":{\n\t\t\tlet months = (end.getFullYear() - start.getFullYear()) * 12;\n\t\t\treturn months + end.getMonth() - (start.getMonth());\n\t\t}\n\t\tcase \"D\":{ \n\t\t\treturn Math.floor(end - start);\n\t\t}\n\t\tcase \"MD\":{\n\t\t\tconst diff = end.getDate() - start.getDate();\n\t\t\tif(diff < 0){\n\t\t\t\tconst startDateDays = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();\n\t\t\t\treturn end.getDate() + startDateDays - start.getDate();\n\t\t\t}\n\t\t\treturn diff;\n\t\t}\n\t\tcase \"YM\":{\n\t\t\tconst months = end.getMonth() - start.getMonth();\n\t\t\treturn months < 0 ? 12 + months : months;\n\t\t}\n\t\tcase \"YD\":{\n\t\t\tconst diff = dayOfTheYear(end) - dayOfTheYear(start);\n\t\t\treturn diff < 0 ? 365 + diff : diff;\n\t\t}\n\t}\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function LINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as date from \"./methods/date\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, date);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import * as methods from \"./math/methods\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(){\n\t\teditor.focus();\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.focus();\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\teditor.define({activeCell:null});\n\t\t\t\teditor.setValue(\"\");\n\t\t\t\teditor.disable();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tif(name == \"lock\" || name == \"filter\" || name == \"dropdown\")\n\t\t\tdisableEditor(options.row,  options.column);\n\t});\n\n\tfunction startEdit(table, cell, clear){\n\t\tvar cellEditor = table.getColumnConfig(cell.column).editor;\n\t\t//do not interfere with custom editors\n\t\tif (cellEditor == \"text\" && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\t\t\tif(!clear)\n\t\t\t\teditor.paintValue();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tif (view.getCellEditor(row, column) || view.isCellLocked(row,column)){\n\t\t\teditor.setValue(\"\");\n\t\t\teditor.disable();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tif(disableEditor(cell.row, cell.column))\n\t\t\treturn false;\n\t\teditor.enable();\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : view.getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\treturn true;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == editor.getInputNode().selectionStart - updateRange.len)\n\t\t\teditor.setRange(range, true);\n\t\telse if(editor.expectOperator())\n\t\t\teditor.setRange(range);\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\twebix.delay(() => editor.focus());\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, rows, cols){\n\t//var [ row, column, value, style] = obj.data[i];\n\tfor (var i=0; i<data.length; i++){\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\twebix.UIManager.setFocus(this.view);\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\": showPreview\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.cell;\n\tvar image = fillUrl(dialog.$dialog.getBody().elements.url.getValue());\n\tdialog.view.addImage(cell.row, cell.column, image);\n\tdialog.close();\n}\n\nfunction showPreview(image){\n\tif (image){\n\t\timage = webix.template.escape(fillUrl(image));\n\t\tthis.getFormView().elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t}\n}\n\nfunction fillUrl(url){\n\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\turl = \"http://\" + url;\n\treturn url;\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tvar cache = passive ? passives : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(activeOnly){\n\tactives = {};\n\tif(!activeOnly)\n\t\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tconst stack = split(formula);\n\tconst max = stack.length;\n\tconst start = area ? area.start : null;\n\tconst end = area ? area.end : null;\n\tconst {count, id} = action;\n\n\tfor (let i = 1; i < max; i+=2) {\n\t\tlet [row, column, flags] = stack[i];\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif (id == \"move\" && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t}\n\t\telse if (id == \"row\" && action.start <= row){\n\t\t\tif(count < 0 && action.start + Math.abs(count) > row){\n\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trow += isRowFix ? 0 : count;\n\t\t}\n\t\telse if (id == \"column\" && action.start <= column){\n\t\t\tif(count < 0 && action.start + Math.abs(count) > column){\n\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcolumn += isColumnFix ? 0 : count;\n\t\t}\n\n\t\tif (column <= 0 || row <= 0)\n\t\t\tstack[i] = \"#REF!\";\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\n\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\": {\n\t\t\t\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\t\t\t\tif(options){\n\t\t\t\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(options, name, newName, extra);\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\t\t\t\tconst option = typeof options[i] == \"string\" ? options[i] : options[i].value;\n\t\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(option, name, newName, extra);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\tconst cache = view._mathSheetCache;\n\n\tif (!cache[name]){\n\t\tconst helpers = (!name || name == getActive(view)) ? activeAccessor(view) : passiveAccessor(view, name);\n\n\t\t//invalid sheet name\n\t\tif(!helpers)\n\t\t\treturn;\n\n\t\tconst temp = cache[name] = SheetAccessor(helpers);\n\n\t\ttemp.init();\n\t}\n\treturn cache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tif (val && val.condition) val = \"\";\n\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test)) return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tconst set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (let i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tif (val && val.condition) val = \"\";\n\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test) ? (val?val:\"\") : test;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst sheet = getSheet(view, name);\n\tif(!sheet)\n\t\treturn;\n\n\tconst page = sheet.content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tvar value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\nimport {clearMathCache} from \"./cache\";\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nexport function rangeValue(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif(pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? page.getRange.apply(page, pos) : [];\n\t\t}\n\t}\n\telse\n\t\tvalues = webix.copy(text);\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i]])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.filter){\n\t\t\tfor (let i=0; i<values.length; i++)\n\t\t\t\tvalues[i] = String(values[i]);\n\t\t}\n\t\tif (extra.order) values.sort();\n\n\t\tconst empty = values.indexOf(\"\");\n\t\tif (empty > -1){\n\t\t\tvalues.splice(empty, 1);\n\t\t\tif (extra.filter)\n\t\t\t\tvalues.unshift( nullFilter() );\n\t\t}\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\tadd(name, text){\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet){\n\t\t\tconst accessor = getAccessor(this._master, sheet);\n\t\t\treturn accessor ? accessor.getRangeCode(name) : null;\n\t\t}\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}\n","import {Dialog} from \"./common\";\nimport {rangeValue} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nvar types = [\n\t{id:\"line\", value:\"Line\"},\n\t{id:\"spline\", value:\"Spline\"},\n\t{id:\"splineArea\", value:\"Spline Area\"},\n\t{id:\"area\", value:\"Area\"},\n\t{id:\"bar\", value:\"Bar\"},\n\t{id:\"pie\", value:\"Pie\"}\n];\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id: \"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:webix.i18n.spreadsheet.labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:types\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValue(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tconst sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id))\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.clearValidation();\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:40 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:40 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\t\tif(id[0] == \"percent\")\n\t\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\tmargin:15,\n\t\t\t\t\t\theight:270,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 155\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.$$(\"bar\").setValues({format:name}, true);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\t\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tlet value = this.view.$$(\"cells\").getItem(this.cell[0].row)[this.cell[0].column];\n\t\tif(value === \"\" || isNaN(value))\n\t\t\tvalue = 1234.56789;\n\t\tthis.value = value;\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\n\t\tconst format = this.getFormat();\n\t\tlet style = {css:\"\"};\n\t\tlet value = fmt.format2code(format.fmt, format.delimiters)(this.value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._safeInt(values.value, 10));\n\t\t\t} else {\n\t\t\t\titem.push([this._safeInt(values.value, 10),this._safeInt(values.value2, 10)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view,\n\t\t\tselect = view.getSelectedId(true),\n\t\t\tcell = select[0];\n\n\t\tif(!select.length) return false;\n\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = item[1][0].toString();\n\t\t\t\t\tvalues.value2 = item[1][1].toString();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = item[1].toString();\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tif(!this.view.getSelectedId())\n\t\t\treturn false;\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t{ width: 25 }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\t\t\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-number\"],\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 500,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tborderless: true,\n\t\t\t\trows: [\n\t\t\t\t\t{rows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tconst values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=LINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=LINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.showTemplate(this.textarea.getValue());\n\t\t\t\t\t\t\t\tthis.changeTextarea();\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t\tthis.$dialog.hide();\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.type = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\t\tthis.size = this.$dialog.getBody().elements[\"size\"];\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.type == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.size.define({ value: value, label: webix.i18n.spreadsheet.labels[this.type == \"row\" ? \"height\" : \"width\"]});\n\t\tthis.size.refresh();\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.getValue()*1;\n\t\tif(this.type == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\t\tthis.close();\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tname: \"size\",\n\t\t\t\tview: \"text\"\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as aiw from \"./image\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ aiw, asw, rgs, dpd, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif(!group || !(prevData && group == prevData.group))\n\t\t\t\tview.refresh();\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span)\n\t\t\tspan[3] = style?style.id:\"\";\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetLockCss(view, options.row, options.column, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif(!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction setLockCss(view, row, column, mode){\n\tvar span = getSpan(view, row, column);\n\tif(span){\n\t\tif(mode){\n\t\t\tif(span[3].indexOf(lockCss) == -1)\n\t\t\t\tspan[3] += \" \"+lockCss;\n\t\t}\n\t\telse\n\t\t\tspan[3] = span[3].replace(\" \"+lockCss,\"\");\n\t\tview._table.refresh();\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {updateMath}  from \"../math/updater\";\nimport {clearMathCache} from \"../math/cache\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tloadChangedData(view,value);\n\t\t}\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import {methods} from \"./methods\";\nimport * as rgs from \"./ranges\";\nimport * as psh from \"./placeholder\";\nimport {changeRange} from \"../helpers/column_names\";\nimport * as sheets from \"./sheet\";\nimport {_parse, clearMathCache} from \"./cache\";\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\n\tview._mathSheetCache = {};\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", updateCell);\n\tview.attachEvent(\"onMathRefresh\", recalckAll);\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _dataParse(view, data));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t\t}\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\n\t\tgrid.refresh();\n\t}\n\n\tfunction updateCell(r, c){\n\t\t//cell value can be updated in types module on cell change, so use getCellValue instead of value argument\n\t\trecalckCell(r, c, view.getCellValue(r, c));\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{},\n\t\te:function(e){throw e;}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction _dataParse(view, obj){\n\tview.ranges.parse(obj.ranges);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import {checkFormat} from \"./formats\";\nimport {getExcelDateFromJs} from \"../math/methods/helpers\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst item = this.getRow(row);\n\t\t\tconst format = item.$cellFormat && item.$cellFormat[col];\n\t\t\tsetType(this, row, col, format, type);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onStyleChange\", function(row, col, style){\n\t\tif(!this._setType){\n\t\t\tconst format = style && style.props && style.props.format;\n\t\t\tsetType(this, row, col, format);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(!this._setType && action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\")\n\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t});\n}\n\nfunction getExpectType(view, row, col, value, parseDate, isFormula){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\t\t\tconst dateFormulas = [\"NOW\", \"DATE\", \"TIME\"];\n\t\t\tfor(let i = 0; i < dateFormulas.length; i++)\n\t\t\t\tif (value.toUpperCase().indexOf(dateFormulas[i] + \"(\") == 1){\n\t\t\t\t\ttype = \"date\"; break;\n\t\t\t\t}\n\t\t}\n\t\telse if(!isNaN(value))\n\t\t\ttype = \"number\";\n\t\telse if(parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tvalue  = webix.i18n.fullDateFormatDate(value);\n\t\t\tif(!isNaN(value)*1){\n\t\t\t\tview.ignoreUndo(function(){\n\t\t\t\t\tvalue = getExcelDateFromJs(value);\n\t\t\t\t\tview.setCellValue(row, col, value);\n\t\t\t\t});\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction checkType(format, type, expectType){\n\ttype = type || expectType;\n\n\tif(format){\n\t\ttype = \"number\";//price, number, percent\n\t\tif(checkFormat(format, \"string\"))\n\t\t\ttype = \"string\";\n\t\telse if(checkFormat(format, \"date\"))\n\t\t\ttype = \"date\";\n\t}\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\n\treturn type;\n}\n\nexport function getType(view, row, column){\n\tconst types = view.getRow(row).$cellType;\n\tif (types && types[column])\n\t\treturn types[column];\n}\n\nfunction setType(view, row, col, format, type){\n\t//prevent type change during onCellChange\n\tview._setType = true;\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst parseDate = !view._loading_data || type == \"date\";\n\tconst expectType = getExpectType(view, row, col, value, parseDate, isFormula);\n\t\n\ttype = checkType(format, type, expectType);\n\tupdateCell(view, row, col, type, expectType, format);\n\n\tconst item = view.getRow(row);\n\tif(!item.$cellType)\n\t\titem.$cellType = {};\n\titem.$cellType[col] = type;\n\n\tdelete view._setType;\n}\n\nfunction updateCell(view, row, col, type, expectType, format){\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\t// add default date format\n\tif(type == \"date\"){\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor){\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t\t}\n\n\t\tif(!checkFormat(format, \"date\")){\n\t\t\tconst isTime = isFormula && value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tformat = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\t}\n\telse{\n\t\t//remove date editor\n\t\tif(cellEditor && cellEditor.editor == \"excel_date\")\n\t\t\tview.setCellEditor(row, col, null);\n\n\t\t//force text format for numbers typed as strings\n\t\tif(!checkFormat(format, \"string\") && type == \"string\" && expectType != \"string\")\n\t\t\tview.setFormat(row, col, \"@\");\n\t}\n}\n","import {rangeValue} from \"../math/ranges\";\nimport {getType} from \"./types\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\treset(view);\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\tconst filter = isFilter(view, id.row, id.column);\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { unique:true, order:true, empty:!filter, filter:filter });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { empty:!filter, filter:filter });\n\t\t\t\t}\n\t\t\t\tif (filter){\n\t\t\t\t\tcol.$mode = getFilterMode(view, id.row, id.column);\n\t\t\t\t\twebix.delay(() => {\n\t\t\t\t\t\tcol.filter = this._ssFilters[id.row][id.column];\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst {row, column} = editor;\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup;\n\t\tdelete col.filter;\n\n\t\tif (isFilter(view, row, column)){\n\t\t\tconst value = view.getCellValue(row,column);\n\t\t\tif (value && (value.includes || (value.condition && value.condition.filter)))\n\t\t\t\tthis.addCellCss(row, column, \"ss_filter_active\");\n\t\t\telse\n\t\t\t\tthis.removeCellCss(row, column, \"ss_filter_active\");\n\t\t\treturn view.filterSpreadSheet();\n\t\t}\n\t});\n\n\tconst cl = table.on_click;\n\tcl.ss_editor = cl.ss_filter = function(e, id){\n\t\tthis.edit(id);\n\t};\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n\tview._table._ssFilters = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor(row in tblEditors){\n\t\tfor(column in tblEditors[row]){\n\t\t\tif(!isFilter(view, row, column))\n\t\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t\t}\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\teditors = data.editors;\n\n\tif(editors)\n\t\tfor(i = 0; i < editors.length; i++)\n\t\t\tview.setCellEditor.apply(view,editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tvar refilter = false;\n\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tlet filter = view._table._ssFilters[cell.row];\n\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t}\n\t\t}\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\tdelete filter[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\t\t\t\trefilter = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tvar filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function addCellFilter(view, row, column, initial){\n\tvar filters = view._table._ssFilters;\n\tvar line = filters[row] = filters[row] || {};\n\tline[column] = [row,column];\n\n\tview.callEvent(\"onAction\", [\"add-filter\", { row, column }]);\n\tif(!initial && view.getCellValue(row,column) != \"\")\n\t\tview.setCellValue(row,column,\"\");\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\teditors = data.editors;\n\n\tif(inc){\n\t\t// create new editors\n\t\tfor(i = editors.length-1;i >=0;i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\t//make copy of editor object\n\t\t\t\teditor = editors[i][2] = webix.copy(editor);\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted, translate, updateFilters){\n\tvar editor = extra.dropdown.editor;\n\tif(extra.dropdown.filter){\n\t\tif(updateFilters){\n\t\t\tvar  options = changeRange(editor.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\t\t\toptions = changeRange(options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\t\t\tview.setCellFilter(row, col, options);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:col, value:null, newValue:{options:options} }]);\n\t\t}\n\t}\n\telse {\n\t\tview.setCellEditor(row, col, editor);\n\t\tif(cutted === 1)\n\t\t\tview.setCellEditor(extra.row, extra.col, {});\n\t}\n}\n\nexport function setFilter(view, row, column, range, initial){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\taddCellFilter(view, row, column, initial);\n\tview.setCellEditor(row,column, { editor:\"ss_excel_filter\", options:range });\n}\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nfunction getFilterMode(view, row, column){\n\tfor (let i=row; i<view.config.rowCount; i++){\n\t\tconst item = view.getRow(i+1);\n\t\tconst value = item[\"$\"+column] || item[column];\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i+1, column);\n\t\t\treturn (type == \"number\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {isFilter, pasteDropdown} from \"../operations/dropdown\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilter();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tvar newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate, updateFilters);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = { editor:editor, filter: !!isFilter(view, id, col) };\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","import {getType} from \"./types\";\n\nexport function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(row){\n\t\tconst item = this.getItem(row);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tconst key = columns[i];\n\t\t\tlet value = item[key];\n\t\t\tconst css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math)\n\t\t\t\tvalue = item[\"$\"+key] || value;\n\n\t\t\t//delete filter value from dataset\n\t\t\tif (value && value.condition) value = \"\";\n\n\t\t\t//put not empty values in serialization\n\t\t\tconst hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tconst type = getType(view, row, key);\n\t\t\t\tdata.push([row*1, key*1, (hasValue ? value : \"\"), css, type]);\n\t\t\t}\n\t\t}\n\t}, true);\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, , type ] = obj.data[i];\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\n\t\t//cell value can be updated via types module\n\t\tview.ignoreUndo(()=>{\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\tgrid.hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split >= start.row)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, config.width).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {changeRange} from \"../helpers/column_names\";\nimport {setFilter} from \"./dropdown\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\tfilter(view);\n\t});\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"filter\"){\n\t\t\tif (!value)\n\t\t\t\tview.removeFilter();\n\t\t\telse\n\t\t\t\tview.setCellFilter(row, column, value.options);\n\t\t}\n\t\telse if (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function getFilters(table){\n\tvar filters = table._ssFilters;\n\tvar all = [];\n\tfor (var row in filters)\n\t\tfor (var column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tlet filters = getFilters(view._table);\n\tlet editors = view._table._ssEditors;\n\t\n\tlet result = data.filters = [];\n\tfor (var i = 0; i<filters.length; i++){\n\t\tlet [row, column] = filters[i];\n\t\tlet options = editors[row][column].options;\n\t\tif(options)\n\t\t\tresult.push([row,column,options]);\n\t}\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tfilters = data.filters;\n\n\tif (filters){\n\t\tfor(i = 0; i < filters.length; i++)\n\t\t\tsetFilter(view, filters[i][0], filters[i][1], filters[i][2], true);\n\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction filter(view, range){\n\trange = range || view._table.getSelectArea();\n\n\tgroup.set(function(){\n\t\tview.removeFilter();\n\t\tif (!range) return;\n\t\tlet row = range.start.row;\n\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\tview.setCellFilter(row, i, range);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:i, value:null, newValue:range }]);\n\t\t}\n\t});\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tfilters = data.filters;\n\n\tif(inc){\n\t\tfor(i = filters.length-1;i >=0;i--){\n\t\t\tlet [row,column,range] = filters[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tfilters[i][0] = name == \"row\"?row*1 + inc:row;\n\t\t\t\tfilters[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t\tfilters[i][2] = changeRange(range, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tview.showSheet(options.sheets[i]);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\t\tdata = data.concat(webix.toExcel(view._table, options));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:options.sheets[i]+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(options.styles)\n\t\t\tdata[i].styles = _getStyles(view, options);\n\t}\n\tview.showSheet(active);\n\t\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\t\t\tif (css)\n\t\t\t\tresult[rIndex][index] = cached[css.id] = webix.copy(cached[css.id] || _getCellStyle(css.text));\n\t\t\telse\n\t\t\t\tresult[rIndex][index] = webix.copy(defaults);\n\n\t\t\tresult[rIndex][index].type = getType(view, row, columns[cIndex].id);\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++)\n\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors)\n\t\tclearEditors(this, rangeStr);\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\t//onCellChange can change item (via types module)\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\titem[column] = value;\n\t\t\t\tdelete item[\"$\"+column];\n\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","import  * as drd from \"../operations/dropdown\";\nimport {getFilters} from \"../operations/filter\";\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellFilter(row, column, range){\n\tdrd.setFilter(this, row, column, range);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || this._table.getItem(row)[column];\n\tconst filter = drd.isFilter(this, row, column);\n\n\tline[column] = editor;\n\n\tif (editor && editor.editor)\n\t\tthis._table.addCellCss(row,column, (filter ? \"ss_filter\": \"ss_editor\"));\n\telse {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, (filter ? \"ss_filter\": \"ss_editor\"));\n\t\tif (filter)\n\t\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}\n\nexport function addFilter(row,column){\n\treturn drd.addCellFilter(this,row,column);\n}\n\nexport function removeFilter(){\n\tvar fs = getFilters(this._table);\n\tfor\t(let i=0; i<fs.length; i++){\n\t\tlet [row,column] = fs[i];\n\t\tlet value = this.getCellEditor(row, column);\n\n\t\tthis.setCellEditor(row, column, null);\n\t\tthis.setCellValue(row, column, \"\");\n\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t\tthis.callEvent(\"onAction\", [\"filter\", {row, column, value, newValue:null }]);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter(function(){ return true; });\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = getFilters(this._table);\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst [row,column, handler] = filters[i];\n\t\t\tconst fv = this._table.getItem(row)[column];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (!fv || all || obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler({ value: String(obj[column]) }) : true;\n\t\t\t}, 1, i);\n\t\t}\n\t}, this);\n\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"add-image\"},\n\t\t{id: \"add-sparkline\"},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{\n\t\tid: \"view\", submenu:[\n\t\t\t{id: \"columns\", submenu: [\n\t\t\t\t{id: \"insert-column\"},\n\t\t\t\t{id: \"delete-column\"},\n\t\t\t\t{id: \"show-column\"},\n\t\t\t\t{id: \"hide-column\"},\n\t\t\t\t{id: \"resize-column\"}\n\t\t\t]},\n\t\t\t{id: \"rows\", submenu: [\n\t\t\t\t{id: \"insert-row\"},\n\t\t\t\t{id: \"delete-row\"},\n\t\t\t\t{id: \"show-row\"},\n\t\t\t\t{id: \"hide-row\"},\n\t\t\t\t{id: \"resize-row\"}\n\t\t\t]},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"freeze-columns\"},\n\t\t\t{id: \"freeze-rows\"},\n\t\t\t{id: \"hide-gridlines\"},\n\t\t\t{id: \"hide-headers\"}\n\t\t]\n\t}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\trows.push(tbl.init(this, tblObj));\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsizeToContent:true,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m16a,m3,m8,m17,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["isChar","char","code","charCodeAt","getWord","formula","i","passive","max","length","sheet","quotes","j","key","substr","webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","title","onChange","hide","getValue","$$","master","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","callEvent","join","palette","colorboard","icon","borderless","height","onSelect","setMasterValue","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","toString","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","buttons","getHeaderConfig","label","paddingX","paddingY","click","getTopParentView","getBodyConfig","content","elements","getFormElements","cancel","autowidth","save","body_setter","_typeof","window","head_setter","padding","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","editor","cursor","getInputNode","selectionStart","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","attachEvent","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","y","x","show","refresh","setValueHere","$enterKey","isVisible","operand","isPosition","test","position","word","row","sum","mode","flags","chars","errorCode","e","namedRangeCode","deps","ranges","getCode","sheetInd","split","rangeCode","b","r1","c1","r2","c2","t","crosssheet","lines","index","ph","escaped","end","next","pushLine","getPopupConfig","onItemClick","button","params","getItem","area","getSelectArea","concat","start","suggestData","highlight","_highlightedCells","_update_range","Date","_last_value_set","showActiveSheet","updateCellValue","delay","_table","moveSelection","preventEvent","eventRemove","keydownEv","event","_this2","endEdit","escapeText","escape","cells","changeCellCss","_ranges","parts","getActiveSheet","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","activeSheet","cell","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","$handleSelection","activeCell","define","showSheet","column","_this3","col","remove","r","c","which","keyCode","dir","getItemNode","innerHTML","newv","getCellValue","setCellValue","$setValueHere","updatedStr","setSelectionRange","expectRange","trim","expectOperator","setRange","range","pos","len","lastPos","isUndefined","prepareArea","first","second","Math","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","blockEvent","_getCheckboxes","count","$all","_count","unblockEvent","base","forEach","labelRight","active","baseHeight","skin","$active","inputHeight","checkboxes","output","scrollview","queryView","form","onSelectChange","focus","conditions","number","batch","handler","getConditions","con","locale","getLabel","dayOfTheYear","date","getFullYear","diff","getTimezoneOffset","floor","getJsDateFromExcel","excelDate","getTime","getExcelDateFromJs","jsDate","_to_number","v","isNaN","_combine","arr","editors","ss_excel_filter","extend","getFilter","getFilterFunction","$mode","clearAll","importData","$initialValue","copy","getEditorArea","rs_popup","popupInit","popupType","$popup","relative","field","$value","excel_date","icons","timepicker","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","newName","_loading_data","clearTimeout","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","nind","d1","d2","notAlphaNum","escapeSheet","toRange","x2","y2","rangeObj","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","align","rowHeight","border_checks","_style_handlers","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","$cellFormat","format","setStyle","_setStyle","setRangeStyle","appendChild","scrollWidth","scrollHeight","removeChild","old","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","setDefaultFormats","formatsLocale","price","getFormat","extra","priceFormat","values","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","round","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","getFormatName","addFormat","nev","splitFormat","conditional","delimiters","errorMessage","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","multiply","lastDateType","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","map","decimal","getParts","left","right","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","Object","keys","sort","timeOrder","order","changeAreaDecimals","getCells","firstValue","firstStyle","rules","isNumber","changeCellDecimals","setValues","updateDecimals","parsed","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","isCustom","formValues","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","Infinity","k","checkFormat","quot","load","defaultFormats","actions","span","isMerged","c0","getSpan","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","eachRow","rowobj","$height","setColumnWidth","adjustRow","eachColumn","getColumnConfig","setRowHeight","highlightColRow","header","sr","er","sc","ec","addCellCss","removeCellCss","getHeaderNode","addCss","removeCss","dragStartColumn","grid","showHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","target","math","editMath","st","ed","addEventListener","parentNode","cellIndex","dragEndColumn","cop","ev","getEditor","isCellLocked","finalStep","ids","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","UIManager","getFocus","need_focus","setFocus","setDefaultCss","$name","spans","leftSplit","areaselect","editable","editaction","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","commented","helper","newvalue","columnCount","rowCount","el","nms","_hideColumn","refreshColumns","hideColumn","parse","_hideRow","env","isMac","addHotKey","readonly","sel","$anyKey","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","state","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","DATE","year","month","day","TIME","hour","minute","DAY","getDate","MONTH","getMonth","YEAR","NOW","DATEDIF","unit","startDateDays","months","IMAGE","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","LINK","IF","neg","methods","strings","other","methodsName","startEdit","clear","cellEditor","fillEditor","disableEditor","getCellEditor","disable","enable","en","pasteRange","updateRange","isEnabled","disabled","find","func","findIndex","actionMap","_activeSheet","add","prepare","selectSheet","showItem","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","getScrollState","tabWidth","context","dataOrder","_sheets","splice","rename","defaultBottom","hidden","editValue","onClick","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","getDimension","_resetTable","Dialog","$dialog","$hide","$show","close","unescape","DialogBox","box","preview","parseImage","server","images","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","dialog","image","fillUrl","addImage","onHideClick","onCancelClick","file","reader","FileReader","onload","getFormView","readAsDataURL","response","imageURL","actives","passives","core","struct","pair","pairsheet","rawword","triggers","parser","_build_function","error_function","clearMathCache","activeOnly","updateMath","action","stack","isRowFix","isColumnFix","cut","updateSheetNames","oldName","thisSheet","multiSheet","getAccessor","_mathSheetCache","helpers","passiveAccessor","page","formulas","_mathSheetHelpers","_mathSheetCore","getRangeCode","getCell","execute","getRange","activeAccessor","SheetAccessor","getRangeValue","rangeValue","unique","String","empty","unshift","nullFilter","$empty","Ranges","_master","accessor","types","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","typesChangeHandler","sparkConfig","getValues","checkRange","addSparkline","alert","clearValidation","getSelectedRange","getRanges","toSheetRange","validate","exists","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","setCellEditor","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","timeFormat","fullDateFormat","longDateFormat","getFormats","updateForm","closeWin","forms","_safeInt","value2","collection","_getCondition","activeValue","_setCondition","_clean","display","onFocus","current_view","clearRow","getRows","getConditionStyle","conditionStyle","_this4","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","minWidth","minHeight","resize","onViewResize","animate","showInput","addComment","onBlur","showTemplate","changeTextarea","comment","open","getHead","columnWidth","bases","aiw","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","lockCss","lockCell","_mapCellsCalls","_locks","newValue","cm","lock","updatePosition","locked","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreUndo","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","addSpan","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","pull","isUndo","undoSpan","setLockCss","checkSpanBorders","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","update","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","rs","vs","m","backtrak","solvedMath","solvedCounter","applyMath","tkey","check_trigger","srow","scolumn","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","updateCell","recalckAll","getState","_dataParse","param","option","addEmptyCollection","_empty","_pull","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","type_action","_undoCondition","_setCssFormat","cssFormat","getType","$cellType","setType","_setType","isFormula","expectType","getExpectType","parseDate","dateFormulas","fullDateFormatDate","isTime","setFormat","checkType","_ssEditors","_ssFilters","clearEditors","refilter","filterSpreadSheet","isFilter","filters","addCellFilter","initial","pasteDropdown","updateFilters","dropdown","setCellFilter","setFilter","getFilterRange","styledata","clipdata","getFilterMode","includes","cl","on_click","ss_editor","ss_filter","tblEditors","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","getElementsByClassName","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","removeFilter","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","isRowVisible","showColumn","unselect","_updatePosition","h","hrows","hcols","_adjustRowHeight","wrap","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","res","removeSelectArea","sorters","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","element","shift","newMath","gridlines","getFilters","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","bottom","top","$exportView","rawValues","ignore","export_mode","_exportExcel","dataOnly","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getTypes","safe","_parseExcel","driver","full","names","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","drd","addFilter","fs","fv","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","submenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","destructor","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","sizeToContent","submenuConfig","onBeforeShow","onMenuItemClick","getMenuItem","trg","contextMenu","dialogs","viewBases","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m16a","m8","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;krEAAA,SAASA,EAAOC,OACXC,EAAOD,EAAKE,WAAW,UAEb,IAAND,GAAYA,GAAM,KAAgB,IAARA,GAAsB,IAARA,EAOjD,SAASE,EAAQC,EAASC,EAAGC,WAJxBL,EAKAM,EAAMH,EAAQI,OACdC,EAAQH,EACRI,GAAS,EAELC,EAAEN,EAAGM,EAAEJ,EAAKI,IAAI,KACnBC,EAAOR,EAAQO,MACP,MAARC,OAKCF,KACO,KAAPE,EAAW,IACG,KAAdR,EAAQC,YAKO,OADjBI,EAAQL,EAAQS,OAAOR,EAAGM,EAAEN,IAClB,KACTI,EAAQA,EAAMI,OAAO,EAAGJ,EAAMD,OAAO,IACtCH,EAAEM,EAAE,OAGD,KAAKZ,EAAOa,UA5BfX,EACS,KADTA,EA4BiCW,EA5BrBV,WAAW,KACRD,GAAM,WA4Bf,CAACG,EAAQS,OAAOR,EAAGM,EAAEN,GAAIM,EAAGN,EAAGI,QAjBvCC,GAAUA,QAsBL,CAACN,EAAQS,OAAOR,GAAIM,EAAGN,EAAGI,GCvClCK,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,gCACG,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,4BACA,8BACC,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH;MACA,gBAEG,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,UAEVC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK,6BACD,qCACF,qCACG,sCACN,8CACE,qCACF,wBACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,WAEhBC,MAAM,gBACW,8BACA,oBACR,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,2BACb,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,kBACC,wBACI,aACT,kBACI,uBACC,oBACL,kBACI,0BACC,8BACI,qBACT,wBACU,wCACH,wCACG,qCACF,mCACA,2BACH,yBACJ,sBACK,WAEfC,MAAM,cACQ,uBACE,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,2BChOpBR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElBC,KAAMR,EAAOQ,QAGdrB,MAAMsB,GAAGC,YChBXvB,MAAMS,QAAQ,CACbC,KAAM,yBACNc,SAAS,CACRC,MAAO,KAERb,MAAO,SAASC,GACfA,EAAOG,KAAO,CACbU,OAAQ,EACRC,KAAK,CACJ,CAAEZ,KAAM,eAAgBa,QAAQ,EAAOC,QAAQ,EAC9CV,OAAQ,EACRC,OAAQ;AACRH,QAAS,CACRC,SAAU,SAASY,UACX9B,MAAMC,KAAKC,YAAYE,SAAS,WAAW0B,EAAIC,MAGxDC,GAAG,CACFC,cAAe,WACAC,KAAKC,gBAAgBA,gBAC3BC,mBAAkB,KAG5BlB,SAAU,SAASY,SAEX,iBADG,0DAA0DA,EAAIO,OAC7C,aAE5BhB,KAAMR,EAAOQ,MAEd,CAAEN,KAAM,oBACR,CACCuB,KAAK,CACJ,CAAEvB,KA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"}